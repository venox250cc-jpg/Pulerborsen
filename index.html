<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>Pulverbörsen – Återbrukad pulverfärg</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #0b1120;      /* mörk ram runt sidan */
  color: #111827;
}
body {
  margin: 0;
  padding: 0 1rem 3rem;
  display: flex;
  justify-content: center;
  background: #0b1120;      /* samma som :root */
}
.page {
  max-width: 960px;
  width: 100%;
}
h1 {
  margin-top: 1.5rem;
  margin-bottom: 0.25rem;
  font-size: 1.8rem;
}
h2 {
  margin-top: 2rem;
  margin-bottom: 0.5rem;
  font-size: 1.3rem;
}
p {
  line-height: 1.5;
  margin: 0.25rem 0;
}
.card {
  background: #f9fafb;      /* lite mjukare ljusgrå istället för kritvitt */
  border-radius: 0.75rem;
  padding: 1rem 1.25rem;
  box-shadow: 0 12px 25px rgba(15, 23, 42, 0.35);
  margin-top: 1rem;
}
.highlight {
  background: #022c22;      /* mörkgrön ruta */
  border-left: 4px solid #16a34a;
  padding: 0.75rem 0.9rem;
  border-radius: 0.5rem;
  margin-top: 0.75rem;
  font-size: 0.9rem;
  color: #ecfdf5;           /* ljus text i rutan */
}
.list-meta {
  font-size: 0.9rem;
  color: #4b5563;
}

  .listing {
  border-radius: 0.75rem;
  border: 1px solid #d1d5db;
  padding: 0.75rem 0.9rem;
  margin-top: 0.85rem;
  background: #f3f4f6;  /* svagt grå så den syns mot kortet */
}
.listing-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.35rem;
}
.listing-title {
  font-weight: 600;
  font-size: 0.98rem;
}
.listing-label {
  font-size: 0.8rem;
  font-weight: 500;
  padding: 0.1rem 0.55rem;
  border-radius: 999px;
  border: 1px solid #d4d4d8;
  background: #f4f4f5;
}

    }
    .listing-row {
      font-size: 0.9rem;
    }
    .listing-row span {
      font-weight: 500;
    }
    .cta-link {
      display: inline-flex;
      margin-top: 0.5rem;
      font-size: 0.9rem;
      text-decoration: none;
      color: #2563eb;
      font-weight: 500;
    }
    .cta-link:hover {
      text-decoration: underline;
    }
    .search-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      margin-top: 0.5rem;
    }
    .search-input {
      flex: 1 1 220px;
      padding: 0.4rem 0.6rem;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      font-size: 0.9rem;
    }
    .search-input:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37,99,235,.15);
    }
    @media (max-width: 640px) {
      .card {
        padding: 0.9rem 0.9rem;
      }
      h1 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header class="card" style="margin-top:1.5rem;">
  <div style="display:flex;align-items:center;gap:0.6rem;margin-bottom:0.5rem;">
    <!-- Enkel ikon -->
    <svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true">
      <circle cx="10" cy="10" r="4" fill="#16a34a"></circle>
      <circle cx="19" cy="8" r="3" fill="#16a34a"></circle>
      <circle cx="20" cy="18" r="5" fill="#111827"></circle>
    </svg>
    <div>
      <div style="font-size:1.6rem;font-weight:700;line-height:1;">Pulverbörsen</div>
      <div style="font-size:0.9rem;color:#4b5563;">Återbrukad pulverfärg</div>
    </div>
  </div>

  <h2 style="margin-top:0.5rem;font-size:1.1rem;">Vad är Pulverbörsen?</h2>
  <p>Pulverbörsen är en enkel marknadsplats där lackerare, verkstäder och tillverkare kan köpa och sälja överbliven pulverfärg istället för att kasta den. Det sparar både pengar och klimatpåverkan.</p>

    <section class="card">
      <h2>Vill du sälja pulverfärg?</h2>
      <p>Har du säckar eller kartonger med pulverfärg som bara står? Ta en bild med mobilen och klicka på knappen nedan så hjälper vi dig lägga upp partiet.</p>

      <p style="font-size:0.9rem;margin-top:0.5rem;"><strong>Så funkar det:</strong></p>
      <ul style="margin-top:0.25rem;padding-left:1.1rem;font-size:0.9rem;">
        <li>Fota säcken/kartongen och gärna märkning/etikett.</li>
        <li>Klicka på knappen nedan – ett mejl till oss öppnas.</li>
        <li>Fyll i uppgifterna, bifoga bilden och skicka.</li>
        <li>Vi lägger upp partiet i listan och återkommer om något saknas.</li>
      </ul>
      <h3 style="margin-top:0.75rem;font-size:1rem;">Så är tanken med priset</h3>
      <p style="font-size:0.9rem;margin-top:0.25rem;">
        Pulverbörsen är tänkt som ett schysst sätt att få <em>något</em> betalt för överskottspulver, istället för att det bara står
        eller kostar pengar att destruera.
      </p>
      <p style="font-size:0.9rem;margin-top:0.25rem;">
        När du skickar in ett parti kommer vi överens om vad du ska få i handen om det säljs. Sedan lägger Pulverbörsen på en liten marginal
        i priset mot slutkund för att täcka plattformen och jobbet med att hitta köpare.
      </p>
      <p style="font-size:0.9rem;margin-top:0.25rem;">
        Du betalar alltså inget för att ligga ute i listan &ndash; bara om pulvret faktiskt blir sålt. Ju mer attraktivt pris du väljer,
        desto snabbare brukar partierna röra på sig.
      </p>

<a
  class="cta-link"
  href="mailto:salj@pulverborsen.se?subject=Jag%20vill%20s%C3%A4lja%20pulverf%C3%A4rg%20via%20Pulverb%C3%B6rsen&body=..."
>
  Sälj pulver – skicka in uppgifter
</a>


    </section>

      <div class="highlight">
        <strong>Klimatvinst i korthet:</strong><br />
        När 20 kg pulverfärg får nytt liv istället för att skrotas kan det grovt motsvara 25–50 kg CO₂ som aldrig behöver produceras. I senare versioner kopplar vi på mer exakta siffror per kulör och mängd.
      </div>
    </header>

    <section class="card">
     <h2>Tillgängliga partier</h2>
<p class="list-meta">Priser anges inkl. moms (25 %) om inget annat anges.</p>
<p id="count" class="list-meta">Laddar lagret…</p>

      <div class="search-row">
        <input
          id="search"
          class="search-input"
          type="text"
          placeholder="Sök på RAL, kulör eller plats (t.ex. 9005, svart, Eskilstuna)"
        />
      </div>

      <div id="listings"></div>
    </section>
  </div>

     <script>
    const listingsEl = document.getElementById("listings");
    const countEl = document.getElementById("count");
    const searchInput = document.getElementById("search");

    const PAGE_SIZE = 20; // hur många partier som visas åt gången

    let allItems = [];
    let visibleItems = [];  // nuvarande filtrerade lista
    let visibleCount = 0;   // hur många av dem som visas just nu

    // Din CSV har kolumnerna:
    // 0: Aktiv (ja/nej)
    // 1: RAL/NCS
    // 2: Kulör
    // 3: Typ
    // 4: Yt/Struktur
    // 5: Mängd
    // 6: Glans
    // 7: Plats
    // 8: Pris_kr_kg
    // 9: Notering
    // 10: CO2_text
    function parseCSV(text) {
      const rows = text.trim().split(/\r?\n/).filter(r => r.trim() !== "");
      if (rows.length <= 1) return [];

      return rows.slice(1).map(row => {
        const cols = row.split(";").map(c => c.trim());
        return {
          aktiv: cols[0] || "",
          ral: cols[1] || "",
          kulor: cols[2] || "",
          typ: cols[3] || "",
          yt: cols[4] || "",
          mangd: cols[5] || "",
          glans: cols[6] || "",
          plats: cols[7] || "",
          pris: cols[8] || "",
          notering: cols[9] || "",
          co2: cols[10] || ""
        };
      }).filter(item => !item.aktiv || item.aktiv.toLowerCase() === "ja");
    }

    function formatKg(value) {
      if (!value) return "–";
      const clean = String(value).replace(/[^\d.,]/g, "");
      return clean ? clean + " kg" : "–";
    }

    function formatPris(value) {
      if (!value) return "Enligt överenskommelse";
      const clean = String(value).replace(/[^\d.,]/g, "");
      return clean ? clean + " kr/kg" : "Enligt överenskommelse";
    }

    // Renderar nuvarande sida (visibleItems + visibleCount)
    function renderPage() {
      listingsEl.innerHTML = "";

      if (!visibleItems.length) {
        countEl.textContent = "Inga partier matchar din sökning.";
        return;
      }

      // totalt antal matchande, inte bara de som visas
      countEl.textContent = `Visar ${visibleItems.length} aktivt part${visibleItems.length === 1 ? "i" : "ier"} ur lagret.`;

      const limit = Math.min(visibleCount, visibleItems.length);

      for (let i = 0; i < limit; i++) {
        const item = visibleItems[i];
        const div = document.createElement("div");
        div.className = "listing";

        const titleParts = [];
        if (item.ral) titleParts.push(item.ral);
        if (item.kulor) titleParts.push(item.kulor);
        const title = titleParts.join(" – ") || "Pulverparti";

        const typYta = [item.typ, item.yt].filter(Boolean).join(", ");
        const co2Text = item.co2 ? `Ca ${item.co2} kg CO₂ sparat` : "";

        const subject = `Beställning Pulverbörsen – ${title}`;
        const bodyLines = [
          "Hej!",
          "",
          "Jag vill köpa följande parti pulverfärg via Pulverbörsen:",
          "",
          `- RAL/kulör: ${title}`,
          `- Mängd: ${formatKg(item.mangd)}`,
          `- Plats: ${item.plats || "-"}`,
          `- Pris: ${formatPris(item.pris)}`,
          "",
          "Mina fakturauppgifter (köpare):",
          "Företag:",
          "Organisationsnummer:",
          "Fakturaadress:",
          "Fakturamottagare / referens:",
          "Faktura-e-post:",
          "",
          "Leveransadress:",
          "Kontaktperson:",
          "Telefon:",
          "",
          "Övrig info:",
          "",
          "Vänligen bekräfta om partiet finns kvar och återkom med orderbekräftelse."
        ];

        const mailto = `mailto:order@pulverborsen.se?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(bodyLines.join("\n"))}`;

        div.innerHTML = `
          <div class="listing-header">
            <div class="listing-title">${title}</div>
            <div class="listing-label">Till salu</div>
          </div>
          <div class="listing-row"><span>Plats:</span> ${item.plats || "–"}</div>
          <div class="listing-row"><span>Mängd:</span> ${formatKg(item.mangd)}</div>
          <div class="listing-row"><span>Typ / yta / glans:</span> ${[typYta, item.glans].filter(Boolean).join(" – ") || "–"}</div>
          <div class="listing-row"><span>Pris:</span> ${formatPris(item.pris)}</div>
          ${co2Text ? `<div class="listing-row"><span>CO₂ (grov uppskattning):</span> ${co2Text}</div>` : ""}
          <a class="cta-link" href="${mailto}">
            Köp det här partiet
          </a>
        `;
        listingsEl.appendChild(div);
      }

      // Om det finns fler än vi visar: lägg en "Visa fler partier"-knapp
      if (visibleCount < visibleItems.length) {
        const btn = document.createElement("button");
        btn.textContent = "Visa fler partier";
        btn.style.marginTop = "0.75rem";
        btn.style.padding = "0.4rem 0.8rem";
        btn.style.borderRadius = "999px";
        btn.style.border = "1px solid #d1d5db";
        btn.style.background = "#ffffff";
        btn.style.cursor = "pointer";
        btn.style.fontSize = "0.9rem";

        btn.addEventListener("click", () => {
          visibleCount += PAGE_SIZE;
          renderPage();
        });

        const wrapper = document.createElement("div");
        wrapper.style.display = "flex";
        wrapper.style.justifyContent = "center";
        wrapper.appendChild(btn);
        listingsEl.appendChild(wrapper);
      }
    }

    function applySearch() {
      const q = searchInput.value.trim().toLowerCase();
      if (!q) {
        visibleItems = allItems.slice();
      } else {
        visibleItems = allItems.filter(item =>
          [item.ral, item.kulor, item.typ, item.yt, item.plats, item.glans, item.notering]
            .some(v => (v || "").toLowerCase().includes(q))
        );
      }
      visibleCount = PAGE_SIZE;
      renderPage();
    }

    searchInput.addEventListener("input", applySearch);

    // Ladda lagret
    fetch("lager.csv?" + Date.now())
      .then(r => r.text())
      .then(text => {
        allItems = parseCSV(text);
        visibleItems = allItems.slice();
        visibleCount = PAGE_SIZE;
        renderPage();
      })
      .catch(err => {
        console.error(err);
        countEl.textContent = "Kunde inte läsa in lagret just nu.";
      });
  </script>


</body>
</html>














